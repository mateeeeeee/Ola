import std.assert;

// Test LICM: 'a * b' is loop-invariant and should be hoisted to preheader
public int TestLICM(int a, int b, int n)
{
    int result = 0;
    for (int i = 0; i < n; i++)
    {
        result += a * b;  // a * b is loop-invariant
    }
    return result;
}

// Test nested loops: inner computation should be hoisted to inner preheader
int TestNestedLoops(int x, int n, int m)
{
    int sum = 0;
    for (int i = 0; i < n; i++)
    {
        int outer = x * 2;  // Loop-invariant for inner loop
        for (int j = 0; j < m; j++)
        {
            sum += outer;  // Uses hoisted value
        }
    }
    return sum;
}

// Simple loop for testing loop analysis
int SimpleSum(int n)
{
    int sum = 0;
    for (int i = 0; i < n; i++)
    {
        sum += i;
    }
    return sum;
}

public int main()
{
    // TestLICM: 3 * 4 = 12, repeated 5 times = 60
    Assert(TestLICM(3, 4, 5) == 60);

    // TestNestedLoops: x*2 = 10, inner loop runs 3 times per outer iteration
    // outer loop runs 2 times, so: 2 * 3 * 10 = 60
    Assert(TestNestedLoops(5, 2, 3) == 60);

    // SimpleSum: 0+1+2+3+4 = 10
    Assert(SimpleSum(5) == 10);

    return 0;
}
